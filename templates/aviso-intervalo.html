<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Intervalo Restante</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/aviso.css') }}">
    <script src="{{ url_for('static', filename='script.js') }}" defer></script>
</head>
<body>
    <div class="container painel">
        <div class="relogio">
            <h1 id="data"></h1>
            <h1 id="hora"></h1>
        </div>
        <div class="box">
            <h1 id="status-evento">{{ mensagem_status }}</h1>
            <p class="tempo" id="countdown-timer">--:--</p>
        </div>
    </div>
    <footer>
        <div class="noticia-rapida">
            {% for n in noticia %}
                <span class="noticia-text">{{ n.conteudo }}</span>
            {% endfor %}
        </div>
    </footer>

    {% if tempo_restante_segundos %}
    <script>
        let tempoRestante = Math.floor({{ tempo_restante_segundos|default(0)|int }});
        const countdownElement = document.getElementById('countdown-timer');
        const statusElement = document.getElementById('status-evento');

        function atualizarContagem() {
            if (tempoRestante <= 0) {
                countdownElement.textContent = "0m 00s";
                statusElement.textContent = "O tempo acabou!";
                clearInterval(intervalo);
                setTimeout(() => { window.location.reload(); }, 5000);
                return;
            }
            const minutos = Math.floor(tempoRestante / 60);
            const segundos = tempoRestante % 60;
            countdownElement.textContent = `${minutos}m ${segundos.toString().padStart(2, '0')}s`;
            tempoRestante--;
        }

        const intervalo = setInterval(atualizarContagem, 1000);
        atualizarContagem();
    </script>
    {% elif mensagem_final %}
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            document.getElementById('countdown-timer').textContent = "Fim";
            document.getElementById('status-evento').innerHTML = "{{ mensagem_final|safe }}";
        });
    </script>
    {% endif %}
</body>
</html>
