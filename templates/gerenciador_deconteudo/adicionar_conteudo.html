<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Adicionar Conteúdo</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/adicionarconteudo.css') }}">
</head>
<body>
    <h1>Adicionar Novo Conteúdo</h1>

    <form action="{{ url_for('admin') }}" method="POST" enctype="multipart/form-data">
        <!-- Tipo -->
        <label for="tipo_conteudo">Tipo de Conteúdo:</label>
        <select name="tipo_conteudo" id="tipo_conteudo" required>
            <option value="noticia_rapida">Notícia Rápida (Barra inferior)</option>
            <option value="mensagem_programada">Mensagem Programada (Tela cheia)</option>
        </select>

        <hr>

        <!-- Bloco: Notícia Rápida -->
        <div id="form-noticia">
            <label for="conteudo_noticia">Conteúdo (máx 150 caracteres):</label>
            <textarea name="conteudo_noticia" id="conteudo_noticia" maxlength="150" rows="3" required></textarea>
        </div>

        <!-- Bloco: Mensagem Programada -->
        <div id="form-mensagem" style="display: none;">
            <label for="mensagem">Mensagem:</label>
            <textarea name="mensagem" id="mensagem" rows="4"></textarea>

            <label for="data_inicio">Início:</label>
            <input type="datetime-local" name="data_inicio" id="data_inicio">

            <label for="data_fim">Fim:</label>
            <input type="datetime-local" name="data_fim" id="data_fim">

            <!-- Novo campo de imagem -->
            <label for="imagem">Enviar Imagem:</label>
            <input type="file" name="imagem" id="imagem" accept="image/*">
        </div>

        <hr>

        <!-- Dispositivos -->
        <h3>Publicar nos Dispositivos:</h3>
        <div class="checkbox-group">
            {% for dispositivo in dispositivos %}
                <label>
                    <input type="checkbox" name="dispositivos" value="{{ dispositivo.id }}">
                    {{ dispositivo.nome }} (IP: {{ dispositivo.ip }})
                </label>
            {% else %}
                <p>Nenhum dispositivo cadastrado. <a href="{{ url_for('gerenciar_dispositivos') }}">Cadastre um primeiro</a>.</p>
            {% endfor %}
        </div>

        <!-- Botões -->
        <div class="button-group">
            <button type="submit">Publicar Conteúdo</button>
            <a href="{{ url_for('admin') }}" class="cancel-link">Cancelar</a>
        </div>
    </form>

    <!-- Script de alternância entre os formulários -->
    <script>
        const tipoConteudo = document.getElementById('tipo_conteudo');
        const formNoticia = document.getElementById('form-noticia');
        const formMensagem = document.getElementById('form-mensagem');

        tipoConteudo.addEventListener('change', function () {
            const isNoticia = this.value === 'noticia_rapida';
            formNoticia.style.display = isNoticia ? 'block' : 'none';
            formMensagem.style.display = isNoticia ? 'none' : 'block';
        });
    </script>

</body>
</html>
